# script_for_VEP
It is a BASH script for correctly creating files for VEP, and then carrying out variant calling
In order to carry out the required analysis on the data, it is necessary to run a specific set of commands. The bowtie command is a bioinformatics tool used for aligning sequencing reads to a reference genome, while preserving the goals of efficacy and flexibility. In the scope of this project, the bowtie command takes single-end sequencing reads related to either the mother, the child or the father and aligns them to the reference genome. FreeBayes is used to find small polymorphisms and indels in high-throughput sequencing data. The output is a VCF file containing information about the identified variants. The VCF file needs to be sequenced for specific patterns according to the nature of the case in study. To do so, the grep command is employed. Bedtools is then needed to find intersections between the VCF file and the BED file containing exon regions. We wrote and run a Bash script to perform the required tasks using these tools. In the Bash Script section, it is possible to consult the code of the script. The main bulk of operations is enclosed in a method named access server. Inside this method, the connection to the remote host is first established. When the script is executed in the terminal, the user is prompted to insert their credentials. Then, several functions are defined. The flow of execution begins with the create_directories function, which receives two arrays as arguments. One features the numbers of the cases in study, the other contains the flags associated with each case. The association between numbers and flags is based on the position in the array. Create_directories creates a new directory for each case inside the user’s main folder. Theoutput files of each analysis will be saved there. Then, apply functions to array is called with the cases’ number and flag as parameters. This function iterates over each case, and at each iteration the generate filename function is called with the number and the flag passed as parameters. Having such information, it is possible to define strings following specific patterns. These strings will be later used to define the names of the output files of the operations to be run. Bowtie function is called three times, one for every person involved in the study (father, mother, and child). In this function, the bowtie2 command is run with parameters specific to the person currently being studied. Bowtie2 is run in a pipeline along with two other commands, samtools view and samtools sort. The latter sorts the results, while the purpose of the former is to convert the SAM file output of the Bowtie2 to BAM. Then, the FreeBayes tool is run inside freebayes_function. Input of this operation are the BAM files generated in the previous step. Later, three grep operations are performed. The first two simply select the header from the VCF file and copies it in a second VCF file. The last grep operation performs the filtering based on a specific pattern that depends on the flag of the case. In the same method, a section of the code is in charge of defining the pattern based on the order in which the child, the mother and the father are saved in the original VCF file. The bedtool operation is later carried out in the same function.
